# Middlewares
Funtions that have the access to modify the request and response cycle, can modify request & response and call the next middleware in application's request-response cycle.

## How middleware work?
Middleware always execute in sequential manner before executing the final funtion. e.g.

    request -> middleware1 -> middleware2 -> middleware1 -> final function

They can modify request at any point of time before executing the final function, end the response and call next middleware to pass the control. 
* If next() is not called and didn't end the response as well, then response will get hanged!

## Types of Middleware

### Application-level middleware
- In express, app.use() is used to mount the middleware funtions.
- app.use() is the primary method for adding funtionalities in our application's request-response cycle.
- Runs on every request, e.g. express.json() or for logging.
#
    const express = require('express');
    const app = express();

    // This parses JSON bodies for all incoming requests
    app.use(express.json())

    // A simple logger middleware
    app.use((req, res, next) => {
    console.log(`Request received: ${req.method} ${req.url}`);
    next();
    });


### Router-level middleware
- used for specific route or group of routes
- for authentication/authorization.

### Built-in middlewares
- funtions that are already written in express framework.
```js
const express = require('express');
const app = express();

app.use(express.static('public')); // Serves static files from the 'public' directory

app.use(express.json()); // Enables parsing of JSON request bodies

app.use(express.urlencoded({extended:false})); // Enables parsing of JSON From request data
```

### Third-party middleware
- modules or funtions which we can use after installing external library.
- e.g. morgan, CORS

### Error-handling middleware
- This middleware has 4 arguments which is used to handle errors
- must be places after all routes/middlware.
```js
app.use((err, req, res, next) => {
console.error(err.stack);
res.status(500).send('Something broke!');
});
```